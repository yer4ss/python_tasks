import telebot
import config
from telebot import types
from telebot.types import InlineKeyboardMarkup, InlineKeyboardButton, ReplyKeyboardMarkup, KeyboardButton
import requests
import time
import requests.exceptions

bot = telebot.TeleBot('7780668347:AAFTwSbXzNg02naVu_g2x-k2GiPiYPVlOng')
api_key = '17697edb22cd6287f4a12ccb3e497513'

regions_data = {
    "–°–µ–≤–µ—Ä–Ω—ã–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω": {"cities": ["–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫", "–ö–æ–∫—à–µ—Ç–∞—É", "–ö–æ—Å—Ç–∞–Ω–∞–π", "–ê—Å—Ç–∞–Ω–∞"]},
    "–Æ–∂–Ω—ã–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω": {"cities": ["–®—ã–º–∫–µ–Ω—Ç", "–¢–∞—Ä–∞–∑", "–ö—ã–∑—ã–ª–æ—Ä–¥–∞", "–¢—É—Ä–∫–µ—Å—Ç–∞–Ω", "–ê–ª–º–∞—Ç—ã"]},
    "–ó–∞–ø–∞–¥–Ω—ã–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω": {"cities": ["–ê—Ç—ã—Ä–∞—É", "–£—Ä–∞–ª—å—Å–∫", "–ê–∫—Ç–∞—É", "–ê–∫—Ç–æ–±–µ"]},
    "–í–æ—Å—Ç–æ—á–Ω—ã–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω": {"cities": ["–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫", "–°–µ–º–µ–π", "–ü–∞–≤–ª–æ–¥–∞—Ä"]},
    "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω": {"cities": ["–ö–∞—Ä–∞–≥–∞–Ω–¥–∞", "–¢–µ–º–∏—Ä—Ç–∞—É", "–ë–∞–ª—Ö–∞—à"]}
}

city_info = {
    "–ê—Å—Ç–∞–Ω–∞": ("–°—Ç–æ–ª–∏—Ü–∞ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, –∏–∑–≤–µ—Å—Ç–Ω–∞—è —Å–≤–æ–µ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –ì–æ—Ä–æ–¥ –∑–Ω–∞–º–µ–Ω–∏—Ç —Å–≤–æ–∏–º–∏ —Ñ—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–¥–∞–Ω–∏—è–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –ë–∞–π—Ç–µ—Ä–µ–∫, –•–∞–Ω –®–∞—Ç—ã—Ä –∏ –î–≤–æ—Ä–µ—Ü –º–∏—Ä–∞ –∏ —Å–æ–≥–ª–∞—Å–∏—è. –í –ê—Å—Ç–∞–Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤–∞–∂–Ω—ã–µ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–µ —Ñ–æ—Ä—É–º—ã –º–∏—Ä–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è. –ó–∏–º–æ–π –≥–æ—Ä–æ–¥ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–Ω–µ–∂–Ω—É—é —Å–∫–∞–∑–∫—É, –∞ –ª–µ—Ç–æ–º –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≥–æ—Å—Ç–µ–π —Å–≤–æ–∏–º–∏ –∑–µ–ª—ë–Ω—ã–º–∏ –ø–∞—Ä–∫–∞–º–∏."),
    "–ê–ª–º–∞—Ç—ã": ("–ö—Ä—É–ø–Ω–µ–π—à–∏–π –≥–æ—Ä–æ–¥ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, –æ–∫—Ä—É–∂—ë–Ω–Ω—ã–π –∂–∏–≤–æ–ø–∏—Å–Ω—ã–º–∏ –≥–æ—Ä–∞–º–∏ –ó–∞–∏–ª–∏–π—Å–∫–æ–≥–æ –ê–ª–∞—Ç–∞—É. –ò–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ –∫—É–ª—å—Ç—É—Ä–Ω—ã–π –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä —Å—Ç—Ä–∞–Ω—ã. –ó–¥–µ—Å—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π –≤—ã—Å–æ–∫–æ–≥–æ—Ä–Ω—ã–π –∫–∞—Ç–æ–∫ –ú–µ–¥–µ–æ, –≥–æ—Ä–Ω–æ–ª—ã–∂–Ω—ã–π –∫—É—Ä–æ—Ä—Ç –®—ã–º–±—É–ª–∞–∫ –∏ —Å–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞ –ö–æ–∫-–¢–æ–±–µ. –ê–ª–º–∞—Ç—ã —Å–ª–∞–≤–∏—Ç—Å—è —Å–≤–æ–∏–º–∏ –∑–µ–ª—ë–Ω—ã–º–∏ —É–ª–∏—Ü–∞–º–∏, —É—é—Ç–Ω—ã–º–∏ –∫–∞—Ñ–µ –∏ –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π."),
    "–®—ã–º–∫–µ–Ω—Ç": ("–¢—Ä–µ—Ç–∏–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ –≥–æ—Ä–æ–¥ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–≤–æ–∏–º–∏ –≤–æ—Å—Ç–æ—á–Ω—ã–º–∏ –±–∞–∑–∞—Ä–∞–º–∏, –≥–æ—Å—Ç–µ–ø—Ä–∏–∏–º—Å—Ç–≤–æ–º –∏ –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π. –û—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –±–æ–ª–µ–µ 2 200 –ª–µ—Ç –Ω–∞–∑–∞–¥, –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –∏–∑ –¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ —Ä–µ–≥–∏–æ–Ω–∞. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç—å —ç—Ç–Ω–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–ª–µ–∫—Å ¬´–ö–µ–Ω-–ë–∞–±–∞¬ª, –º–µ–¥—Ä–µ—Å–µ XIX –≤–µ–∫–∞ –∏ –ê—Ä—Ö–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º—É–∑–µ–π."),
    "–ö–æ–∫—à–µ—Ç–∞—É": ("–ñ–∏–≤–æ–ø–∏—Å–Ω—ã–π –≥–æ—Ä–æ–¥, –æ–∫—Ä—É–∂—ë–Ω–Ω—ã–π –æ–∑—ë—Ä–∞–º–∏ –∏ –ª–µ—Å–∞–º–∏. –ö–æ–∫—à–µ—Ç–∞—É —Å–ª–∞–≤–∏—Ç—Å—è —Å–≤–æ–∏–º–∏ –∫—É—Ä–æ—Ä—Ç–Ω—ã–º–∏ –∑–æ–Ω–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –ë—É—Ä–∞–±–∞–π –∏ –ó–µ—Ä–µ–Ω–¥–∞, –ø—Ä–∏–≤–ª–µ–∫–∞—é—â–∏–º–∏ —Ç—É—Ä–∏—Å—Ç–æ–≤ –∫—Ä—É–≥–ª—ã–π –≥–æ–¥. –ë—É—Ä–∞–±–∞–π —á–∞—Å—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç \"–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω—Å–∫–æ–π –®–≤–µ–π—Ü–∞—Ä–∏–µ–π\" –∏–∑-–∑–∞ –µ–≥–æ –≥–æ—Ä–Ω—ã—Ö –ø–µ–π–∑–∞–∂–µ–π –∏ —á–∏—Å—Ç—ã—Ö –æ–∑—ë—Ä."),
    "–ö–æ—Å—Ç–∞–Ω–∞–π": ("–ì–æ—Ä–æ–¥ —Å –±–æ–≥–∞—Ç—ã–º –∫—É–ª—å—Ç—É—Ä–Ω—ã–º –Ω–∞—Å–ª–µ–¥–∏–µ–º, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–∞ —Å–µ–≤–µ—Ä–µ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø–∞–º—è—Ç–Ω–∏–∫–∏, –º—É–∑–µ–∏ –∏ —Ç–µ–∞—Ç—Ä—ã. –í —Ä–µ–≥–∏–æ–Ω–µ —Ä–∞–∑–≤–∏—Ç–∞ —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–∞—è –∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –æ—Ç—Ä–∞—Å–ª—å. –í –ö–æ—Å—Ç–∞–Ω–∞–µ —Ç–∞–∫–∂–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –µ–∂–µ–≥–æ–¥–Ω—ã–π —Ñ–µ—Å—Ç–∏–≤–∞–ª—å ¬´–¢–æ–±–æ–ª-—Ñ–µ—Å—Ç¬ª, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã–π –Ω–∞—Ä–æ–¥–Ω—ã–º —Ç—Ä–∞–¥–∏—Ü–∏—è–º."),
    "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫": ("–û–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä–µ–π—à–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤ XVIII –≤–µ–∫–µ. –ó–¥–µ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞–º—è—Ç–Ω–∏–∫–æ–≤, –≤–∫–ª—é—á–∞—è –ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫—É—é –∫—Ä–µ–ø–æ—Å—Ç—å. –ì–æ—Ä–æ–¥ –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º–∏ —É—é—Ç–Ω—ã–º–∏ –Ω–∞–±–µ—Ä–µ–∂–Ω—ã–º–∏, –∞ —Ç–∞–∫–∂–µ –º—É–∑–µ–µ–º –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã–º —Ç–≤–æ—Ä—á–µ—Å—Ç–≤—É –∫–∞–∑–∞—Ö—Å–∫–∏—Ö –ø–∏—Å–∞—Ç–µ–ª–µ–π."),
    "–¢–∞—Ä–∞–∑": ("–û–¥–∏–Ω –∏–∑ –¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ê–∑–∏–∏ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –±–æ–ª–µ–µ 2 000 –ª–µ—Ç. –¢–∞—Ä–∞–∑ —Å–ª–∞–≤–∏—Ç—Å—è –¥—Ä–µ–≤–Ω–∏–º–∏ –º–∞–≤–∑–æ–ª–µ—è–º–∏ –ö–∞—Ä–∞—Ö–∞–Ω–∞ –∏ –ê–π—à–∞-–±–∏–±–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –≤–∞–∂–Ω—ã–º–∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–º–∏ –ø–∞–º—è—Ç–Ω–∏–∫–∞–º–∏. –ì–æ—Ä–æ–¥ —Ç–∞–∫–∂–µ –Ω–∞–∑—ã–≤–∞—é—Ç '–∫–æ–ª—ã–±–µ–ª—å—é –∫–∞–∑–∞—Ö—Å–∫–æ–π —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏' –∑–∞ –µ–≥–æ –∞—Ä—Ö–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ."),
    "–ö—ã–∑—ã–ª–æ—Ä–¥–∞": ("–ì–æ—Ä–æ–¥ –Ω–∞ —Ä–µ–∫–µ –°—ã—Ä–¥–∞—Ä—å—è, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –ó–¥–µ—Å—å –≤ XIX –≤–µ–∫–µ —Ä–∞—Å–ø–æ–ª–∞–≥–∞–ª–∞—Å—å –ø–µ—Ä–≤–∞—è —Å—Ç–æ–ª–∏—Ü–∞ –ö–∞–∑–∞—Ö—Å–∫–æ–π –ê–°–°–†. –ö—ã–∑—ã–ª–æ—Ä–¥–∞ —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∫–∞–∫ —Ü–µ–Ω—Ç—Ä –∫–∞–∑–∞—Ö—Å–∫–æ–π –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–∏—Å—å–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –∞ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π –∫–æ—Å–º–æ–¥—Ä–æ–º –ë–∞–π–∫–æ–Ω—É—Ä."),
    "–¢—É—Ä–∫–µ—Å—Ç–∞–Ω": ("–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –¥—Ä–µ–≤–Ω–∏—Ö –∏ —Å–≤—è—â–µ–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–∞–≤–∑–æ–ª–µ–π –•–æ–¥–∂–∏ –ê—Ö–º–µ–¥–∞ –Ø—Å–∞–≤–∏ ‚Äì –æ–±—ä–µ–∫—Ç –í—Å–µ–º–∏—Ä–Ω–æ–≥–æ –Ω–∞—Å–ª–µ–¥–∏—è –Æ–ù–ï–°–ö–û. –¢—É—Ä–∫–µ—Å—Ç–∞–Ω —è–≤–ª—è–µ—Ç—Å—è –¥—É—Ö–æ–≤–Ω—ã–º –∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–º —Ü–µ–Ω—Ç—Ä–æ–º —Å—Ç—Ä–∞–Ω—ã, –µ–∂–µ–≥–æ–¥–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—é—â–∏–º —Ç—ã—Å—è—á–∏ –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤ –∏ —Ç—É—Ä–∏—Å—Ç–æ–≤."),
    "–ê—Ç—ã—Ä–∞—É": ("–ù–µ—Ñ—Ç—è–Ω–∞—è —Å—Ç–æ–ª–∏—Ü–∞ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–∞—è –Ω–∞ —Ä–µ–∫–µ –£—Ä–∞–ª. –ì–æ—Ä–æ–¥ —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏, –µ–≤—Ä–æ–ø–µ–π—Å–∫—É—é –∏ –∞–∑–∏–∞—Ç—Å–∫—É—é. –ê—Ç—ã—Ä–∞—É –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º–∏ —Ä—ã–±–Ω—ã–º–∏ –ø—Ä–æ–º—ã—Å–ª–∞–º–∏, –Ω–µ—Ñ—Ç—è–Ω—ã–º–∏ –º–µ—Å—Ç–æ—Ä–æ–∂–¥–µ–Ω–∏—è–º–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –Ω–µ–±–æ—Å–∫—Ä—ë–±–∞–º–∏."),
    "–£—Ä–∞–ª—å—Å–∫": ("–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –≥–æ—Ä–æ–¥ –Ω–∞ –∑–∞–ø–∞–¥–µ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤ XVI –≤–µ–∫–µ. –£—Ä–∞–ª—å—Å–∫ —Å–ª–∞–≤–∏—Ç—Å—è —Å–≤–æ–µ–π —Å—Ç–∞—Ä–∏–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –æ—Å–æ–±–µ–Ω–Ω–æ –ö–∞–∑–∞–Ω—Å–∫–∏–º —Å–æ–±–æ—Ä–æ–º –∏ –¥–æ–º–æ–º –ü—É–≥–∞—á—ë–≤–∞. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç—å –º—É–∑–µ–∏, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∫–∞–∑–∞—á–µ—Å—Ç–≤–∞ –∏ –¥—Ä–µ–≤–Ω–µ–≥–æ –ó–æ–ª–æ—Ç–æ–≥–æ –û—Ä–¥—ã."),
    "–ê–∫—Ç–∞—É": ("–ì–æ—Ä–æ–¥ —É –ö–∞—Å–ø–∏–π—Å–∫–æ–≥–æ –º–æ—Ä—è —Å –∫—Ä–∞—Å–∏–≤—ã–º–∏ –ø–ª—è–∂–∞–º–∏ –∏ —Å–∫–∞–ª–∏—Å—Ç—ã–º–∏ –ø–µ–π–∑–∞–∂–∞–º–∏. –Ø–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º –ø–æ—Ä—Ç–æ–≤—ã–º –∏ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–º —Ü–µ–Ω—Ç—Ä–æ–º. –í–±–ª–∏–∑–∏ –≥–æ—Ä–æ–¥–∞ –º–æ–∂–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç—å —É—Ä–æ—á–∏—â–µ –ë–æ—Å–∂–∏—Ä–∞ –∏ –ø–æ–¥–∑–µ–º–Ω—É—é –º–µ—á–µ—Ç—å –ë–µ–∫–µ—Ç-–ê—Ç–∞, —Å—á–∏—Ç–∞—é—â—É—é—Å—è —Å–≤—è—Ç—ã–Ω–µ–π."),
    "–ê–∫—Ç–æ–±–µ": ("–î–∏–Ω–∞–º–∏—á–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—é—â–∏–π—Å—è –≥–æ—Ä–æ–¥ –Ω–∞ –∑–∞–ø–∞–¥–µ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –ó–¥–µ—Å—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –∫—Ä—É–ø–Ω—ã–µ –º–µ—Ç–∞–ª–ª—É—Ä–≥–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–æ–¥—ã –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã. –í –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç—è—Ö –≥–æ—Ä–æ–¥–∞ –º–æ–∂–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è ‚Äì –º–µ–ª–æ–≤—ã–µ –≥–æ—Ä—ã –ê–∫—Ç–∞—É."),
    "–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫": ("–ì–æ—Ä–æ–¥ –º–µ—Ç–∞–ª–ª—É—Ä–≥–æ–≤, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π —Å—Ä–µ–¥–∏ –≥–æ—Ä –í–æ—Å—Ç–æ—á–Ω–æ–≥–æ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –û–Ω –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º–∏ –∫—Ä–∞—Å–∏–≤—ã–º–∏ –ø—Ä–∏—Ä–æ–¥–Ω—ã–º–∏ –ø–µ–π–∑–∞–∂–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –ë—É—Ö—Ç–∞—Ä–º–∏–Ω—Å–∫–æ–µ –≤–æ–¥–æ—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∫ –ö–∞—Ç–æ–Ω-–ö–∞—Ä–∞–≥–∞–π."),
    "–°–µ–º–µ–π": ("–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –≥–æ—Ä–æ–¥, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∏–º–µ–Ω–µ–º –ê–±–∞—è –ö—É–Ω–∞–Ω–±–∞–µ–≤–∞. –í –°–µ–º–µ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –º—É–∑–µ–π –ê–±–∞—è, —Å—Ç–∞—Ä–µ–π—à–∞—è –º–µ—á–µ—Ç—å –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞ –∏ –º–æ—Å—Ç —á–µ—Ä–µ–∑ –ò—Ä—Ç—ã—à ‚Äì –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –¥–ª–∏–Ω–Ω—ã—Ö –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –ê–∑–∏–∏."),
    "–ü–∞–≤–ª–æ–¥–∞—Ä": ("–ì–æ—Ä–æ–¥ —Å —Ä–∞–∑–≤–∏—Ç–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å—é –∏ –∂–∏–≤–æ–ø–∏—Å–Ω—ã–º–∏ –Ω–∞–±–µ—Ä–µ–∂–Ω—ã–º–∏. –ü–∞–≤–ª–æ–¥–∞—Ä –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ–∞—Ç—Ä–∞–º–∏, –º—É–∑–µ—è–º–∏ –∏ –±–ª–∏–∑–æ—Å—Ç—å—é –∫ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø–∞—Ä–∫—É –ë–∞—è–Ω–∞—É–ª."),
    "–ö–∞—Ä–∞–≥–∞–Ω–¥–∞": ("–ö—Ä—É–ø–Ω—ã–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —É–≥–æ–ª—å–Ω–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å—é. –ì–æ—Ä–æ–¥ —Å–ª–∞–≤–∏—Ç—Å—è —Å–≤–æ–∏–º —Ç–µ–∞—Ç—Ä–æ–º –∏–º–µ–Ω–∏ –°—Ç–∞–Ω–∏—Å–ª–∞–≤—Å–∫–æ–≥–æ –∏ –ø–∞—Ä–∫–æ–º –ë–æ—Ç–∞–Ω–∏—á–µ—Å–∫–∏–π —Å–∞–¥. –ù–µ–¥–∞–ª–µ–∫–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º—É–∑–µ–π –ì–£–õ–ê–ì–∞ –≤ –ø–æ—Å–µ–ª–∫–µ –î–æ–ª–∏–Ω–∫–∞."),
    "–¢–µ–º–∏—Ä—Ç–∞—É": ("–ì–æ—Ä–æ–¥ –º–µ—Ç–∞–ª–ª—É—Ä–≥–æ–≤, –≤–∞–∂–Ω—ã–π —Ü–µ–Ω—Ç—Ä —á—ë—Ä–Ω–æ–π –º–µ—Ç–∞–ª–ª—É—Ä–≥–∏–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫—Ä—É–ø–Ω–µ–π—à–∏–π –º–µ—Ç–∞–ª–ª—É—Ä–≥–∏—á–µ—Å–∫–∏–π –∑–∞–≤–æ–¥ —Å—Ç—Ä–∞–Ω—ã. –¢–∞–∫–∂–µ –≥–æ—Ä–æ–¥ –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º –ª–µ–¥–æ–≤—ã–º –¥–≤–æ—Ä—Ü–æ–º –∏ –∂–∏–≤–æ–ø–∏—Å–Ω–æ–π –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π —Ä–µ–∫–∏ –ù—É—Ä–∞."),
    "–ë–∞–ª—Ö–∞—à": ("–ì–æ—Ä–æ–¥ –Ω–∞ –±–µ—Ä–µ–≥—É –æ–¥–Ω–æ–∏–º—ë–Ω–Ω–æ–≥–æ –æ–∑–µ—Ä–∞, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É –ø—Ä–µ—Å–Ω–æ–µ, –Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É —Å–æ–ª—ë–Ω–æ–µ. –ë–∞–ª—Ö–∞—à –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç —Ç—É—Ä–∏—Å—Ç–æ–≤ —Å–≤–æ–∏–º–∏ –ø–ª—è–∂–∞–º–∏, —Ä—ã–±–∞–ª–∫–æ–π –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –ø—Ä–∏—Ä–æ–¥–æ–π.")
}

city_images = {
    "–ê—Å—Ç–∞–Ω–∞": "A:/yer4ss/Work/im python/bot gid/images/–ê—Å—Ç–∞–Ω–∞.jpg",
    "–ê–ª–º–∞—Ç—ã": "A:/yer4ss/Work/im python/bot gid/images/–ê–ª–º–∞—Ç—ã.jpg",
    "–®—ã–º–∫–µ–Ω—Ç": "A:/yer4ss/Work/im python/bot gid/images/–®—ã–º–∫–µ–Ω—Ç.jpg",
    "–ö–æ–∫—à–µ—Ç–∞—É": "A:/yer4ss/Work/im python/bot gid/images/–ö–æ–∫—à–µ—Ç–∞—É.jpg",
    "–ö–æ—Å—Ç–∞–Ω–∞–π": "A:/yer4ss/Work/im python/bot gid/images/–ö–æ—Å—Ç–∞–Ω–∞–π.jpg",
    "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫": "A:/yer4ss/Work/im python/bot gid/images/–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫.jpg",
    "–¢–∞—Ä–∞–∑": "A:/yer4ss/Work/im python/bot gid/images/–¢–∞—Ä–∞–∑.jpg",
    "–ö—ã–∑—ã–ª–æ—Ä–¥–∞": "A:/yer4ss/Work/im python/bot gid/images/–ö—ã–∑—ã–ª–æ—Ä–¥–∞.jpg",
    "–¢—É—Ä–∫–µ—Å—Ç–∞–Ω": "A:/yer4ss/Work/im python/bot gid/images/–¢—É—Ä–∫–µ—Å—Ç–∞–Ω.jpg",
    "–ê—Ç—ã—Ä–∞—É": "A:/yer4ss/Work/im python/bot gid/images/–ê—Ç—ã—Ä–∞—É.jpg",
    "–£—Ä–∞–ª—å—Å–∫": "A:/yer4ss/Work/im python/bot gid/images/–£—Ä–∞–ª—å—Å–∫.jpg",
    "–ê–∫—Ç–∞—É": "A:/yer4ss/Work/im python/bot gid/images/–ê–∫—Ç–∞—É.jpg",
    "–ê–∫—Ç–æ–±–µ": "A:/yer4ss/Work/im python/bot gid/images/–ê–∫—Ç–æ–±–µ.jpg",
    "–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫": "A:/yer4ss/Work/im python/bot gid/images/–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫.jpg",
    "–°–µ–º–µ–π": "A:/yer4ss/Work/im python/bot gid/images/–°–µ–º–µ–π.jpg",
    "–ü–∞–≤–ª–æ–¥–∞—Ä": "A:/yer4ss/Work/im python/bot gid/images/–ü–∞–≤–ª–æ–¥–∞—Ä.jpg",
    "–ö–∞—Ä–∞–≥–∞–Ω–¥–∞": "A:/yer4ss/Work/im python/bot gid/images/–ö–∞—Ä–∞–≥–∞–Ω–¥–∞.jpg",
    "–¢–µ–º–∏—Ä—Ç–∞—É": "A:/yer4ss/Work/im python/bot gid/images/–¢–µ–º–∏—Ä—Ç–∞—É.jpg",
    "–ë–∞–ª—Ö–∞—à": "A:/yer4ss/Work/im python/bot gid/images/–ë–∞–ª—Ö–∞—à.jpg"
}

city_maps = {
    "–ê—Å—Ç–∞–Ω–∞": "https://www.google.com/maps/search/?q=–ê—Å—Ç–∞–Ω–∞&hl=ru",
    "–ê–ª–º–∞—Ç—ã": "https://www.google.com/maps/search/?q=–ê–ª–º–∞—Ç—ã&hl=ru",
    "–®—ã–º–∫–µ–Ω—Ç": "https://www.google.com/maps/search/?q=–®—ã–º–∫–µ–Ω—Ç&hl=ru",
    "–ö–æ–∫—à–µ—Ç–∞—É": "https://www.google.com/maps/search/?q=–ö–æ–∫—à–µ—Ç–∞—É&hl=ru",
    "–ö–æ—Å—Ç–∞–Ω–∞–π": "https://www.google.com/maps/search/?q=–ö–æ—Å—Ç–∞–Ω–∞–π&hl=ru",
    "–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫": "https://www.google.com/maps/search/?q=–ü–µ—Ç—Ä–æ–ø–∞–≤–ª–æ–≤—Å–∫&hl=ru",
    "–¢–∞—Ä–∞–∑": "https://www.google.com/maps/search/?q=–¢–∞—Ä–∞–∑&hl=ru",
    "–ö—ã–∑—ã–ª–æ—Ä–¥–∞": "https://www.google.com/maps/search/?q=–ö—ã–∑—ã–ª–æ—Ä–¥–∞&hl=ru",
    "–¢—É—Ä–∫–µ—Å—Ç–∞–Ω": "https://www.google.com/maps/search/?q=–¢—É—Ä–∫–µ—Å—Ç–∞–Ω&hl=ru",
    "–ê—Ç—ã—Ä–∞—É": "https://www.google.com/maps/search/?q=–ê—Ç—ã—Ä–∞—É&hl=ru",
    "–£—Ä–∞–ª—å—Å–∫": "https://www.google.com/maps/search/?q=–£—Ä–∞–ª—å—Å–∫&hl=ru",
    "–ê–∫—Ç–∞—É": "https://www.google.com/maps/search/?q=–ê–∫—Ç–∞—É&hl=ru",
    "–ê–∫—Ç–æ–±–µ": "https://www.google.com/maps/search/?q=–ê–∫—Ç–æ–±–µ&hl=ru",
    "–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫": "https://www.google.com/maps/search/?q=–£—Å—Ç—å-–ö–∞–º–µ–Ω–æ–≥–æ—Ä—Å–∫&hl=ru",
    "–°–µ–º–µ–π": "https://www.google.com/maps/search/?q=–°–µ–º–µ–π&hl=ru",
    "–ü–∞–≤–ª–æ–¥–∞—Ä": "https://www.google.com/maps/search/?q=–ü–∞–≤–ª–æ–¥–∞—Ä&hl=ru",
    "–ö–∞—Ä–∞–≥–∞–Ω–¥–∞": "https://www.google.com/maps/search/?q=–ö–∞—Ä–∞–≥–∞–Ω–¥–∞&hl=ru",
    "–¢–µ–º–∏—Ä—Ç–∞—É": "https://www.google.com/maps/search/?q=–¢–µ–º–∏—Ä—Ç–∞—É&hl=ru",
    "–ë–∞–ª—Ö–∞—à": "https://www.google.com/maps/search/?q=–ë–∞–ª—Ö–∞—à&hl=ru"
}

categories = {
    "–ö—É–¥–∞ –º–æ–∂–Ω–æ —Å—Ö–æ–¥–∏—Ç—å": ["–ü–∞—Ä–∫–∏", "–ö–∞—Ñ–µ", "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã", "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã"],
    "–ì–¥–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–æ—á–µ–≤–∞—Ç—å": ["–ú–æ—Ç–µ–ª–∏", "–û—Ç–µ–ª–∏", "–°—ä—ë–º–Ω—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã"]
}

places_data = {
    "–ê—Å—Ç–∞–Ω–∞": {
        "–ü–∞—Ä–∫–∏": {"–ü–∞—Ä–∫ –ê—Ç–∞–º–µ–∫–µ–Ω": "—É–ª. –¢–∞—É–µ–ª—Å–∏–∑–¥–∏–∫ 1", "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∏–π –ø–∞—Ä–∫": "–ø—Ä. –¢—É—Ä–∞–Ω 57"},
        "–ö–∞—Ñ–µ": {"–ö–∞—Ñ–µ –ê—Å—Ç–∞–Ω–∞": "—É–ª. –°–∞—Ä—ã–∞—Ä–∫–∞ 10", "–ö–æ—Ñ–µ–π–Ω—è Relax": "–ø—Ä. –ö–∞–±–∞–Ω–±–∞–π –±–∞—Ç—ã—Ä–∞ 22"},
        "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã": {"Satti": "—É–ª. –ö—É–Ω–∞–µ–≤–∞ 14", "Line Brew": "—É–ª. –ë–µ–π–±–∏—Ç—à–∏–ª–∏–∫ 3"},
        "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã": {"–•–∞–Ω –®–∞—Ç—ã—Ä": "–ø—Ä. –¢—É—Ä–∞–Ω 37", "MEGA Silk Way": "–ø—Ä. –ö–∞–±–∞–Ω–±–∞–π –±–∞—Ç—ã—Ä–∞ 62"}
    },
    "–ê–ª–º–∞—Ç—ã": {
        "–ü–∞—Ä–∫–∏": {"–ü–∞—Ä–∫ –ü–∞–Ω—Ñ–∏–ª–æ–≤–∞": "—É–ª. –ö–∞–ª–¥–∞—è–∫–æ–≤–∞ 22", "–ö–æ–∫ –¢–æ–±–µ": "—É–ª. –î–æ—Å—Ç—ã–∫ 104"},
        "–ö–∞—Ñ–µ": {"–ö–∞—Ñ–µ Del Papa": "–ø—Ä. –ê–±–∞—è 30", "Traveler's Coffee": "—É–ª. –°–∞—Ç–ø–∞–µ–≤–∞ 30"},
        "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã": {"Daredzhani": "—É–ª. –ñ–∞–º–±—ã–ª–∞ 77", "BarFly": "—É–ª. –ë–∞–π—Ç—É—Ä—Å—ã–Ω–æ–≤–∞ 101"},
        "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã": {"Dostyk Plaza": "—É–ª. –°–∞—Ç–ø–∞–µ–≤–∞ 111", "MEGA Park": "–ø—Ä. –°–µ–π—Ñ—É–ª–ª–∏–Ω–∞ 58"}
    },
    "–®—ã–º–∫–µ–Ω—Ç": {
        "–ü–∞—Ä–∫–∏": {"–ü–∞—Ä–∫ –ê–±–∞—è": "—É–ª. –î—É–ª–∞—Ç–∏ 5", "–ü–∞—Ä–∫ –ñ–∏–±–µ–∫ –ñ–æ–ª—ã": "–ø—Ä. –†–µ—Å–ø—É–±–ª–∏–∫–∏ 8"},
        "–ö–∞—Ñ–µ": {"–ö–∞—Ñ–µ Central": "—É–ª. –ë–∞–π—Ç–µ—Ä–µ–∫–æ–≤–∞ 20", "Korzinka Coffee": "–ø—Ä. –ö—É–Ω–∞–µ–≤–∞ 12"},
        "–†–µ—Å—Ç–æ—Ä–∞–Ω—ã": {"–ö–∞–∑–∞—Ö—Å–∫–∞—è –Æ—Ä—Ç–∞": "—É–ª. –¢–æ–ª–µ –±–∏ 18", "Aladdin": "—É–ª. –ê–±–∞—è 47"},
        "–¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã": {"–®—ã–º–∫–µ–Ω—Ç Plaza": "—É–ª. –†—ã—Å–∫—É–ª–æ–≤–∞ 12", "–§–∏—Ä–∫–∞–Ω City": "—É–ª. –¢–∞—É–∫–µ —Ö–∞–Ω–∞ 45"}
    }
}

# –ö–µ—à –ø–æ–≥–æ–¥—ã
weather_cache = {}
CACHE_TIMEOUT = 600  # 10 –º–∏–Ω—É—Ç

# –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –º–µ—Å—Ç–∞
user_favorites = {}

@bot.message_handler(commands=['start'])
def start(message):
    markup = InlineKeyboardMarkup()
    for region in regions_data:
        markup.add(InlineKeyboardButton(region, callback_data=region))
    bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω:", reply_markup=markup)

@bot.message_handler(commands=['help'])
def help(message):
    bot.send_message(message.chat.id, "–≠—Ç–æ—Ç –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥–æ—Ä–æ–¥–∞—Ö –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω –∏ –≥–æ—Ä–æ–¥, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –æ –Ω—ë–º –±–æ–ª—å—à–µ.\n")

@bot.message_handler(commands=['about'])
def about(message):
    bot.send_message(message.chat.id, "–≠—Ç–æ—Ç –±–æ—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥–æ—Ä–æ–¥–∞—Ö –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞. "
                                        "–î–∞–Ω–Ω—ã–µ –æ –≥–æ—Ä–æ–¥–∞—Ö –∏ –ø–æ–≥–æ–¥–µ –±–µ—Ä—É—Ç—Å—è —Å –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. "
                                        "–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API OpenWeatherMap.\n")

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥—ã —Å –∫–µ—à–µ–º
def get_weather(city):
    current_time = time.time()
    if city in weather_cache and current_time - weather_cache[city]['time'] < CACHE_TIMEOUT:
        return weather_cache[city]['data']

    url = f"https://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}&units=metric&lang=ru"
    response = requests.get(url).json()
    if response.get("main"):
        weather_desc = response['weather'][0]['description']
        temp = response["main"]["temp"]
        wind = response["wind"]["speed"]
        humidity = response["main"]["humidity"]
        pressure = response["main"]["pressure"]
        cloudiness = response["clouds"]["all"]

        weather_data = (
            f"{weather_desc.capitalize()}\n"
            f"üå°Ô∏è –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {temp}¬∞C\n"
            f"üí® –í–µ—Ç–µ—Ä: {wind} –º/—Å\n"
            f"üíß –í–ª–∞–∂–Ω–æ—Å—Ç—å: {humidity}%\n"
            f"üîΩ –î–∞–≤–ª–µ–Ω–∏–µ: {pressure} –º–º —Ä—Ç. —Å—Ç.\n"
            f"‚òÅÔ∏è –û–±–ª–∞—á–Ω–æ—Å—Ç—å: {cloudiness}%"
        )
        weather_cache[city] = {'data': weather_data, 'time': current_time}
        return weather_data

    else:
        return "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É."



@bot.callback_query_handler(func=lambda call: call.data in regions_data)
def select_region(call):
    region = call.data
    markup = InlineKeyboardMarkup()
    for city in regions_data[region]["cities"]:
        markup.add(InlineKeyboardButton(city, callback_data=city))
    markup.add(InlineKeyboardButton("<< –ù–∞–∑–∞–¥", callback_data="back"))
    bot.edit_message_text(f"–í—ã –≤—ã–±—Ä–∞–ª–∏ —Ä–µ–≥–∏–æ–Ω {region}. –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥:", call.message.chat.id, call.message.message_id, reply_markup=markup)


@bot.callback_query_handler(func=lambda call: call.data == "back")
def back(call):
    markup = InlineKeyboardMarkup()
    for region in regions_data:
        markup.add(InlineKeyboardButton(region, callback_data=region))
    bot.edit_message_text("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω:", call.message.chat.id, call.message.message_id, reply_markup=markup)


@bot.callback_query_handler(func=lambda call: call.data in city_info)
def select_city(call):
    city = call.data
    info = city_info[city]
    weather = get_weather(city)
    img_path = city_images.get(city)

    try:
        with open(img_path, "rb") as photo:
            bot.send_photo(call.message.chat.id, photo, caption=f"{city}: {info}")
        bot.send_message(call.message.chat.id, f"üå§Ô∏è –ü–æ–≥–æ–¥–∞ –≤ {city}: {weather}")

    except requests.exceptions.ConnectionError:
        bot.send_message(call.message.chat.id, f"‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º. –ü—Ä–æ–±—É—é —Å–Ω–æ–≤–∞...")
        time.sleep(5)
        select_city(call)  # –ü—Ä–æ–±—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ

    except Exception as e:
        bot.send_message(call.message.chat.id, f"‚ö†Ô∏è –û—à–∏–±–∫–∞: {e}")




# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
@bot.callback_query_handler(func=lambda call: call.data.startswith("category"))
def show_places(call):
    _, city, category = call.data.split("_")
    places = places_data.get(city, {}).get(category, {})
    for place, address in places.items():
        bot.send_message(call.message.chat.id, f"{place}\n–ê–¥—Ä–µ—Å: {address}\n[–°–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ](https://www.google.com/maps/search/{place.replace(' ', '+')})", parse_mode="Markdown")
    bot.send_message(call.message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –µ—â—ë –º–µ—Å—Ç–æ –∏–ª–∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞–∑–∞–¥:", reply_markup=create_buttons(categories.keys(), "category", city))

# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫
def create_buttons(buttons_data, prefix, city=None):
    markup = types.InlineKeyboardMarkup()
    for item in buttons_data:
        callback_data = f"{prefix}_{item}" if city is None else f"{prefix}_{city}_{item}"
        markup.add(types.InlineKeyboardButton(item, callback_data=callback_data))
    markup.add(types.InlineKeyboardButton("–ù–∞–∑–∞–¥", callback_data="back"))
    return markup

bot.polling(none_stop=True)